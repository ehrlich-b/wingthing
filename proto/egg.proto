syntax = "proto3";
package egg;
option go_package = "github.com/ehrlich-b/wingthing/internal/egg/pb";

service Egg {
    rpc Kill(KillRequest) returns (KillResponse);
    rpc Resize(ResizeRequest) returns (ResizeResponse);
    rpc Session(stream SessionMsg) returns (stream SessionMsg);
}

message KillRequest { string session_id = 1; }
message KillResponse {}

message ResizeRequest {
    string session_id = 1;
    uint32 rows = 2;
    uint32 cols = 3;
}
message ResizeResponse {}

message SessionMsg {
    string session_id = 1;
    oneof payload {
        bytes output = 2;
        bytes input = 3;
        Resize resize = 4;
        int32 exit_code = 5;
        bool attach = 6;
        bool detach = 7;
    }
}

message Resize {
    uint32 rows = 1;
    uint32 cols = 2;
}
