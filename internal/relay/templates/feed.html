{{define "title"}}{{.SlugName}} — wingthing.ai{{end}}
{{define "head"}}
<style>
.feed-header{margin-bottom:16px;display:flex;align-items:baseline;gap:12px;flex-wrap:wrap}
.feed-header h1{font-size:20px;font-weight:700;letter-spacing:-0.02em;text-transform:lowercase}
.feed-header .desc{font-size:13px;color:var(--text-dim);font-weight:400}
.sort-tabs{display:flex;gap:2px;margin-bottom:12px;font-family:var(--mono);font-size:12px}
.sort-tabs a{color:var(--text-dim);text-decoration:none;padding:4px 10px;border-radius:3px;transition:background 0.1s}
.sort-tabs a:hover{background:rgba(255,255,255,0.05);color:var(--text)}
.sort-tabs a.active{color:var(--text);background:var(--bg-card);font-weight:600}
.feed-layout{display:flex;gap:24px}
.feed-main{flex:1;min-width:0}
.feed-sidebar{width:180px;flex-shrink:0}
.feed-sidebar h3{font-size:11px;text-transform:uppercase;color:var(--text-dim);margin-bottom:8px;letter-spacing:0.05em;font-family:var(--mono)}
.feed-sidebar a{display:block;font-size:12px;color:var(--text-dim);text-decoration:none;padding:2px 0;font-family:var(--mono)}
.feed-sidebar a:hover{color:var(--text)}
.feed-sidebar a.active{color:var(--text);font-weight:600}
.feed-list{list-style:none}
.feed-item{padding:8px 6px;border-bottom:1px solid rgba(255,255,255,0.05)}
.feed-item:last-child{border-bottom:none}
.feed-row{display:flex;gap:8px;align-items:flex-start}
.vote-btn{background:none;border:none;color:var(--text-dim);cursor:pointer;padding:2px 4px;font-size:11px;line-height:1;flex-shrink:0;margin-top:3px;transition:color 0.1s}
.vote-btn:hover{color:var(--action)}
.vote-btn.voted{color:var(--action)}
.feed-content{flex:1;min-width:0}
.feed-title{font-size:16px;line-height:1.4}
.feed-title a{color:var(--text);text-decoration:underline;text-decoration-color:rgba(255,255,255,0.2);text-underline-offset:2px}
.feed-title a:hover{text-decoration-color:rgba(255,255,255,0.5)}
.feed-title .domain{font-size:12px;color:var(--text-dim);font-weight:400;margin-left:4px}
.feed-meta{font-size:12px;color:var(--text-dim);margin-top:3px;font-family:var(--mono)}
.feed-meta a{color:var(--text-dim);text-decoration:none}
.feed-meta a:hover{color:var(--text)}
@media(max-width:700px){
  .feed-sidebar{display:none}
  .feed-header h1{font-size:18px}
  .feed-item{padding:6px 2px}
  .feed-title{font-size:14px}
  .feed-meta{font-size:10px}
  .sort-tabs{font-size:11px}
  .sort-tabs a{padding:3px 8px}
}
</style>
{{end}}
{{define "content"}}
<div class="feed-header">
<h1>{{.SlugName}}</h1>
{{if .Description}}<span class="desc">{{.Description}}</span>{{end}}
</div>
<div class="sort-tabs">
<a href="/w/{{.Slug}}"{{if eq .Sort "hot"}} class="active"{{end}}>hot</a>
<a href="/w/{{.Slug}}?sort=new"{{if eq .Sort "new"}} class="active"{{end}}>new</a>
<a href="/w/{{.Slug}}?sort=week"{{if eq .Sort "week"}} class="active"{{end}}>week</a>
<a href="/w/{{.Slug}}?sort=month"{{if eq .Sort "month"}} class="active"{{end}}>month</a>
<a href="/w/{{.Slug}}?sort=year"{{if eq .Sort "year"}} class="active"{{end}}>year</a>
</div>
<div class="feed-layout">
<div class="feed-main">
<ul class="feed-list">
{{range .Items}}
<li class="feed-item">
<div class="feed-row">
<button class="vote-btn{{if .Voted}} voted{{end}}" onclick="vote(event,'{{.PostID}}')" title="upvote">&#9650;</button>
<div class="feed-content">
<div class="feed-title">
{{if .Link}}<a href="{{.Link}}" target="_blank" rel="noopener">{{.Title}}</a>{{else}}<a href="/p/{{.PostID}}">{{.Title}}</a>{{end}}
{{if .Domain}}<span class="domain">({{.Domain}})</span>{{end}}
</div>
<div class="feed-meta">
{{.Age | timeAgo}}
{{range .Anchors}} · <a href="/w/{{.}}">{{. | slugDisplay}}</a>{{end}}
· <a href="/p/{{.PostID}}">discuss</a>
</div>
</div>
</div>
</li>
{{end}}
</ul>
{{if not .Items}}<div style="color:var(--text-dim);padding:32px 0;text-align:center">no posts yet</div>{{end}}
</div>
<div class="feed-sidebar">
<h3>spaces</h3>
<a href="/w/all"{{if not .Slug}} class="active"{{end}}>all</a>
{{range .AllAnchors}}<a href="/w/{{.}}"{{if eq . $.Slug}} class="active"{{end}}>{{. | slugDisplay}}</a>
{{end}}
</div>
</div>
<script>
var loggedIn={{.LoggedIn}};
function vote(e,id){
  e.stopPropagation();
  if(!loggedIn){window.location='/login';return;}
  var btn=e.currentTarget;
  btn.classList.toggle('voted');
  fetch('/api/vote',{method:'POST',headers:{'Content-Type':'application/json'},credentials:'same-origin',body:JSON.stringify({post_id:id})});
}
</script>
{{end}}
