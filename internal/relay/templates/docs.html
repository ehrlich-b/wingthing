{{define "title"}}docs - wingthing.ai{{end}}
{{define "head"}}
<style>
.docs-layout{display:flex;gap:32px;align-items:flex-start}
.docs-nav{position:sticky;top:24px;min-width:160px;flex-shrink:0;font-family:var(--mono);font-size:12px;display:block;justify-content:initial;align-items:initial;padding:0;border-bottom:none;margin-bottom:0}
.docs-nav a{display:block;color:var(--text-dim);text-decoration:none;padding:5px 0;border-left:2px solid transparent;padding-left:10px}
.docs-nav a:hover,.docs-nav a.active{color:var(--text);border-left-color:var(--action)}
.docs-body{flex:1;min-width:0;max-width:780px}
.docs-body h1{font-size:24px;font-weight:700;letter-spacing:-0.03em;margin-bottom:8px}
.docs-body>p.lead{color:var(--text-dim);font-size:14px;line-height:1.6;margin-bottom:28px}
.docs-section{margin-bottom:40px}
.docs-section h2{font-size:17px;font-weight:600;margin-bottom:12px;color:var(--action);padding-top:16px}
.docs-section p{color:var(--text-dim);font-size:14px;line-height:1.6;margin-bottom:12px}
.docs-section ul{color:var(--text-dim);font-size:14px;line-height:1.6;margin-bottom:12px;padding-left:20px}
.docs-section li{margin-bottom:4px}
.docs-code{background:var(--bg-card);border-radius:6px;padding:14px 20px;font-size:13px;line-height:1.7;font-family:var(--mono);overflow-x:auto;margin-bottom:16px}
.docs-code .prompt{color:var(--text-dim);user-select:none}
.docs-code .cmd{color:var(--text)}
.docs-code .comment{color:#666}
.docs-table{width:100%;border-collapse:collapse;font-size:13px;font-family:var(--mono);margin-bottom:16px}
.docs-table th,.docs-table td{text-align:left;padding:8px 12px;border-bottom:1px solid var(--accent)}
.docs-table th{color:var(--text-dim);font-weight:400}
.vocab-table{width:100%;border-collapse:collapse;font-size:14px;margin-bottom:16px}
.vocab-table th,.vocab-table td{text-align:left;padding:10px 12px;border-bottom:1px solid var(--accent)}
.vocab-table th{color:var(--text-dim);font-weight:400;font-family:var(--mono);font-size:12px}
.vocab-table td:first-child{color:var(--action);font-weight:600;font-family:var(--mono);white-space:nowrap}
@media(max-width:700px){
  .docs-nav{display:none}
  .docs-body h1{font-size:20px}
  .docs-code{font-size:11px;padding:12px 14px}
}
</style>
{{end}}
{{define "content"}}
<div class="docs-layout">
<nav class="docs-nav">
<a href="#quickstart">quickstart</a>
<a href="#overview">overview</a>
<a href="#installation">installation</a>
<a href="#wing-setup">wing setup</a>
<a href="#wing-configuration">wing configuration</a>
<a href="#access-control">access control</a>
<a href="#organizations">organizations</a>
<a href="#shared-wings">shared wings</a>
<a href="#idle-timeouts">idle timeouts</a>
<a href="#egg-configuration">egg configuration</a>
<a href="#self-hosting">self-hosting</a>
<a href="#roost-configuration">roost configuration</a>
<a href="#architecture">architecture</a>
<a href="#security">security</a>
<a href="#sandbox-limits">sandbox limits</a>
</nav>
<div class="docs-body">
<h1>documentation</h1>
<p class="lead">wingthing runs AI agents sandboxed on your machine, accessible from anywhere.</p>

<div class="docs-section" id="quickstart">
<h2>quickstart</h2>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">using wingthing.ai</h3>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">curl -fsSL https://wingthing.ai/install.sh | sh</span><br>
<span class="prompt">$ </span><span class="cmd">wt login</span><br>
<span class="prompt">$ </span><span class="cmd">wt start</span><br>
<span class="prompt">$ </span><span class="cmd">open app.wingthing.ai</span>
</div>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">run your own</h3>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">curl -fsSL https://wingthing.ai/install.sh | sh</span><br>
<span class="prompt">$ </span><span class="cmd">wt roost start</span><span class="comment">        # server + wing, one command</span><br>
<span class="prompt">$ </span><span class="cmd">open localhost:8080</span>
</div>

<p>Your machine is now a <strong>wing</strong> â€” a remote-accessible sandbox host. Open a terminal from the browser, pick an agent (Claude, Codex, Ollama), and it runs in an isolated <strong>egg</strong> on your hardware. All traffic is end-to-end encrypted through the <strong>roost</strong>.</p>
</div>

<div class="docs-section" id="overview">
<h2>overview</h2>
<p>wingthing is a CLI tool (<code>wt</code>) that lets you run Claude Code, Codex, Ollama, and other AI agents in sandboxed sessions on your own hardware - then access them from any device through an encrypted connection.</p>
<table class="vocab-table">
<tr><th>term</th><th>what it is</th></tr>
<tr><td>wing</td><td>Your machine. Install <code>wt</code>, run <code>wt start</code>, and it connects outbound to the roost. One machine = one wing.</td></tr>
<tr><td>roost</td><td>The server. Handles login and routes connections. wingthing.ai is a roost. <code>wt roost start</code> runs your own.</td></tr>
<tr><td>egg</td><td>A sandboxed agent session. Each egg is an isolated process with its own PTY, sandbox profile, and gRPC socket. Runs Claude, Codex, Ollama, etc.</td></tr>
</table>
<p>Wings connect outbound to the roost (no port forwarding needed), and the roost bridges WebSocket connections between wings and browsers. All PTY traffic is E2E encrypted.</p>
</div>

<div class="docs-section" id="installation">
<h2>installation</h2>
<p>Single binary, no dependencies. macOS and Linux, x64 and arm64.</p>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">curl -fsSL https://wingthing.ai/install.sh | sh</span>
</div>
<p>Installs to <code>~/.local/bin/wt</code>. Set <code>WT_INSTALL_DIR</code> to change the location.</p>
<p>Or grab the binary from <a href="https://github.com/ehrlich-b/wingthing/releases/latest">GitHub releases</a>.</p>
<p>To update:</p>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">wt update</span>
</div>
</div>

<div class="docs-section" id="wing-setup">
<h2>wing setup</h2>
<p>Three commands to go from install to remote access:</p>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">wt login</span><span class="comment">                  # authenticate with the roost</span><br>
<span class="prompt">$ </span><span class="cmd">wt start</span><span class="comment">                  # start the wing daemon</span><br>
<span class="prompt">$ </span><span class="cmd">open app.wingthing.ai</span><span class="comment">     # start terminals from your browser</span>
</div>
<p><code>wt start</code> runs the wing as a background daemon. Use <code>wt wing start --foreground</code> for debugging.</p>
<p>Other wing commands:</p>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">wt wing status</span><span class="comment">            # check daemon status + active sessions</span><br>
<span class="prompt">$ </span><span class="cmd">wt stop</span><span class="comment">                   # stop the wing daemon</span>
</div>
</div>

<div class="docs-section" id="wing-configuration">
<h2>wing configuration</h2>
<p>Wing settings live in <code>~/.wingthing/wing.yaml</code>. You can edit the file directly or use the CLI:</p>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">wt wing config</span><span class="comment">                    # view current config</span><br>
<span class="prompt">$ </span><span class="cmd">wt wing config set org=myteam</span><span class="comment">     # set a value</span><br>
<span class="prompt">$ </span><span class="cmd">wt wing config set audit=true</span><span class="comment">     # enable session audit recording</span>
</div>
<p>The daemon picks up changes via SIGHUP. See the reload column for what requires a restart.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">config fields</h3>
<table class="docs-table">
<tr><th>field</th><th>effect</th><th>reload</th></tr>
<tr><td>org</td><td>organization slug - share this wing with org members</td><td>restart</td></tr>
<tr><td>paths</td><td>project directories to expose (default: CWD). Also settable via <code>wt start --paths ~/repos,~/projects</code></td><td>live</td></tr>
<tr><td>labels</td><td>freeform tags shown in the web UI (e.g. "gpu", "linux", "work")</td><td>live</td></tr>
<tr><td>locked</td><td>enable passkey access control. See <a href="#access-control">access control</a></td><td>live</td></tr>
<tr><td>auth_ttl</td><td>passkey nonce lifetime. Default <code>0</code> (boot-scoped - valid until wing restarts). Set to e.g. <code>1h</code> to force re-authentication periodically</td><td>live</td></tr>
<tr><td>admins</td><td>emails with admin role - admins see all sessions and all paths</td><td>live</td></tr>
<tr><td>idle_timeout</td><td>kill idle sessions after this duration (e.g. <code>4h</code>). Default: disabled</td><td>live</td></tr>
<tr><td>egg_config</td><td>path to default <code>egg.yaml</code> for sessions on this wing</td><td>live</td></tr>
<tr><td>audit</td><td>record session terminal output for replay</td><td>live</td></tr>
<tr><td>debug</td><td>verbose daemon logging</td><td>live</td></tr>
<tr><td>conv</td><td>conversation context file path</td><td>live</td></tr>
</table>
</div>

<div class="docs-section" id="access-control">
<h2>access control</h2>
<p>By default, anyone with your account credentials can start sessions on your wing. Locking it adds a second factor using <a href="https://passkeys.dev">passkeys</a> - the same WebAuthn standard behind "Sign in with Face ID" and "Sign in with Windows Hello."</p>
<p>A passkey is a cryptographic credential stored in your password manager (1Password, LastPass, iCloud Keychain, Bitwarden) or your OS (Touch ID, Windows Hello, Android biometrics). Most people already have one and don't know it.</p>
<p>When your wing is locked, browsers must prove they hold a passkey on the allowlist before the wing will start or reattach a session. The roost can't fake this - the cryptographic challenge-response happens directly between your browser and your wing.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">lock your wing</h3>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">wt wing lock</span>
</div>
<p>Once locked, the browser shows an "authenticate with passkey" button when you open a session. Click it, verify with your fingerprint or password manager, and the session starts. The wing issues a nonce that's valid for the rest of the boot - you won't be prompted again until the wing restarts. Set <code>auth_ttl</code> if you want periodic re-authentication on top of that.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">manage the allowlist</h3>
<p>When locked, only passkeys on the allowlist can access the wing:</p>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">wt wing allow</span><span class="comment">                     # list allowed users</span><br>
<span class="prompt">$ </span><span class="cmd">wt wing allow --email user@co.com</span><span class="comment"> # allow a specific user</span><br>
<span class="prompt">$ </span><span class="cmd">wt wing allow --all</span><span class="comment">               # allow all org members</span><br>
<span class="prompt">$ </span><span class="cmd">wt wing revoke user@co.com</span><span class="comment">        # remove from allowlist</span><br>
<span class="prompt">$ </span><span class="cmd">wt wing revoke --all</span><span class="comment">              # clear the allowlist</span>
</div>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">unlock</h3>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">wt wing unlock</span>
</div>
<p>Removes the passkey requirement. Sessions start without a second factor.</p>
<p>The allowlist lives in <code>wing.yaml</code> on your machine. The roost stores your passkey's public key and credential ID so it can hand them to your wing during <code>wt wing allow</code>. The security model assumes the roost is not compromised at the time you add a key - after that, verification happens entirely on the wing.</p>
</div>

<div class="docs-section" id="organizations">
<h2>organizations</h2>
<p>Orgs let a team share wings. Create one from the web UI (account page), then invite members by email. Members see all wings in the org.</p>
<p>To attach a wing to an org:</p>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">wt wing config set org=myteam</span>
</div>
<p>Or pass it at start time:</p>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">wt start --org myteam</span>
</div>
<p>Org wings show up for all org members in the web UI. Combine with <code>wt wing lock</code> to require passkey auth - org membership gets you visibility, but the wing owner controls who can actually start sessions.</p>
</div>

<div class="docs-section" id="shared-wings">
<h2>shared wings</h2>
<p>Multiple users can share a single wing. Each user gets an isolated home directory, and you can restrict which folders each person sees.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">adding users</h3>
<p>Set up OAuth on your roost (GitHub or Google), and users log in through the browser. Each authenticated user automatically gets their own home directory at <code>~/.wingthing/user-homes/&lt;hash&gt;/</code> with shell configs and agent binaries symlinked from the host. The owner gets a per-user home too - there's no bypass for local users.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">restricting paths</h3>
<p>By default, all users see all configured paths. Add <code>members</code> to restrict access per folder:</p>
<div class="docs-code">
<span class="comment"># wing.yaml</span><br>
paths:<br>
&nbsp;&nbsp;- ~/docs<span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# everyone</span><br>
&nbsp;&nbsp;- path: ~/repos/api<br>
&nbsp;&nbsp;&nbsp;&nbsp;members: [alice@co.com, bob@co.com]<span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# only alice and bob</span><br>
&nbsp;&nbsp;- path: ~/repos/infra<br>
&nbsp;&nbsp;&nbsp;&nbsp;members:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- carol@co.com<span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# only carol</span>
</div>
<p>Owners and admins always see everything regardless of member lists.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">admin role</h3>
<p>Add emails to the <code>admins</code> list in <code>wing.yaml</code>. Admins see all sessions and all paths - same visibility as the wing owner.</p>
<div class="docs-code">
<span class="comment"># wing.yaml</span><br>
admins:<br>
&nbsp;&nbsp;- admin@co.com<br>
&nbsp;&nbsp;- ops@co.com
</div>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">agent settings</h3>
<p>Override agent config for all users on a wing with <code>agent_settings</code> in <code>egg.yaml</code>:</p>
<div class="docs-code">
<span class="comment"># egg.yaml</span><br>
agent_settings:<br>
&nbsp;&nbsp;claude: /opt/wingthing/claude-settings.json
</div>
<p>Host settings take precedence over user preferences. For Claude, <code>apiKeyHelper</code> in the settings file keeps <code>ANTHROPIC_API_KEY</code> out of the agent's environment.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">environment</h3>
<p>Every egg gets these variables, available to CLAUDE.md, scripts, and any process inside the session:</p>
<table class="docs-table">
<tr><th>variable</th><th>value</th></tr>
<tr><td>WT_SESSION_ID</td><td>session UUID</td></tr>
<tr><td>WT_USER</td><td>normalized username from email</td></tr>
<tr><td>WT_USER_EMAIL</td><td>authenticated email address</td></tr>
<tr><td>WT_USER_NAME</td><td>display name (Google full name, GitHub login)</td></tr>
<tr><td>WT_PREVIEW_DIR</td><td>working directory path</td></tr>
<tr><td>WT_PREVIEW_FILE</td><td>.wt-preview-&lt;session-id&gt;</td></tr>
</table>
</div>

<div class="docs-section" id="idle-timeouts">
<h2>idle timeouts</h2>
<p>Kill sessions that go quiet. Set <code>idle_timeout</code> in <code>wing.yaml</code>:</p>
<div class="docs-code">
<span class="comment"># wing.yaml</span><br>
idle_timeout: 4h
</div>
<p>A session is idle when there's no output from the agent and no input from the user. Agent thinking generates PTY output, so active sessions won't be killed. Default is disabled - sessions run until stopped manually.</p>
</div>

<div class="docs-section" id="egg-configuration">
<h2>egg configuration</h2>
<p>Without an <code>egg.yaml</code>, the sandbox applies opinionated defaults: CWD is writable, home is read-only, sensitive directories (<code>~/.ssh</code>, <code>~/.gnupg</code>, <code>~/.aws</code>, etc.) are denied, and only essential env vars pass through. <code>~/.ssh/known_hosts</code> is preserved read-only so SSH can verify host keys without prompting (add <code>deny:~/.ssh/known_hosts</code> to disable this). Network is blocked except for exactly what your agent needs - each agent has a profile declaring its API domains, env vars, and config directories. Claude gets <code>api.anthropic.com</code>, Ollama gets <code>localhost</code>, etc. You don't configure any of this.</p>
<p>A local <a href="https://en.wikipedia.org/wiki/HTTP_tunnel">CONNECT proxy</a> enforces domain-level filtering - agents can only reach their own API, not the entire internet. On macOS, Seatbelt forces all traffic through the proxy at the OS level. On Linux, the proxy is set via <code>HTTPS_PROXY</code>.</p>
<p>Drop an <code>egg.yaml</code> in your project to customize. Configs are additive - you only declare what you're changing from the defaults.</p>
<p>Place <code>egg.yaml</code> in your project directory for per-project config, or in <code>~/.wingthing/egg.yaml</code> for global defaults. Project configs are discovered automatically. Use the <a href="/">sandbox builder</a> on the homepage to generate configs visually, or install the <a href="https://github.com/ehrlich-b/wingthing/tree/main/docs/skills/create-egg">Claude Code skill</a> for an interactive security interview that generates hardened configs.</p>
<p>Example <code>egg.yaml</code>:</p>
<div class="docs-code">
fs:<br>
&nbsp;&nbsp;- "ro:~/.ssh"<span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# override the default deny for ~/.ssh</span><br>
network:<br>
&nbsp;&nbsp;- "github.com"<span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# add a domain on top of agent defaults</span><br>
env:<br>
&nbsp;&nbsp;- SSH_AUTH_SOCK<span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# pass SSH agent socket</span><br>
dangerously_skip_permissions: true
</div>
<p>The sandbox auto-injects mounts for the agent binary's install root and config directory, so you don't need to know where Claude or Codex is installed. Use <code>base: none</code> for a blank slate if you want full control.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">what each config field does</h3>
<table class="docs-table">
<tr><th>field</th><th>effect</th></tr>
<tr><td>fs</td><td>filesystem rules: <code>rw:PATH</code>, <code>ro:PATH</code>, <code>deny:PATH</code>, <code>deny-write:PATH</code>. Additive on top of defaults</td></tr>
<tr><td>network</td><td>domain allowlist, merged with agent defaults. Use <code>"*"</code> for unrestricted</td></tr>
<tr><td>env</td><td>extra env vars to pass through (agent-required vars are auto-injected)</td></tr>
<tr><td>dangerously_skip_permissions</td><td>let the agent run without asking - the sandbox is the permission boundary</td></tr>
<tr><td>agent_settings</td><td>map of agent name to settings file path (e.g. <code>claude: /path/to/settings.json</code>). Host settings override user prefs</td></tr>
<tr><td>base</td><td>inherit from another config. <code>none</code> for blank slate, or a path to another egg.yaml</td></tr>
<tr><td>cpu *</td><td>CPU time limit as a duration string, e.g. <code>300s</code> or <code>5m</code>. Linux only, ignored on macOS</td></tr>
<tr><td>memory *</td><td>memory limit, e.g. <code>4G</code>. Linux only, ignored on macOS</td></tr>
<tr><td>max_fds *</td><td>max open file descriptors. Linux only, ignored on macOS</td></tr>
<tr><td>max_pids *</td><td>max processes in cgroup. Linux only, requires cgroups v2</td></tr>
</table>
<p style="font-size:12px;color:var(--text-dim)">* Linux only. macOS Seatbelt doesn't support resource limits. If these limitations are blocking you, <a href="https://github.com/ehrlich-b/wingthing/issues">file an issue</a>.</p>
</div>

<div class="docs-section" id="self-hosting">
<h2>self-hosting</h2>
<p>Run your own roost. Single binary, SQLite, no external dependencies.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">quick start</h3>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">wt roost start</span>
</div>
<p>Open <a href="http://localhost:8080">localhost:8080</a>. Server and wing in one process, no login page, no config.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">multi-user</h3>
<p>Same command, add OAuth env vars. Now multiple people can log in.</p>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">GITHUB_CLIENT_ID=xxx GITHUB_CLIENT_SECRET=yyy wt roost start</span>
</div>
<p>Or use Google OAuth with <code>GOOGLE_CLIENT_ID</code> and <code>GOOGLE_CLIENT_SECRET</code>. Connect additional wings from other machines with <code>wt login --roost https://my-roost.example.com</code> and <code>wt start --roost https://my-roost.example.com</code>. Or set <code>roost_url</code> in <code>~/.wingthing/config.yaml</code> to avoid passing the flag every time.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">running separately</h3>
<p>If you need the server and wing on different machines, run them as separate processes:</p>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">wt serve</span><span class="comment">                          # server only</span><br>
<span class="comment"># on another machine:</span><br>
<span class="prompt">$ </span><span class="cmd">wt start --roost http://host:port</span><span class="comment">   # wing only</span>
</div>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">systemd</h3>
<div class="docs-code">
[Unit]<br>
Description=wingthing roost<br>
After=network.target<br>
<br>
[Service]<br>
ExecStart=/usr/local/bin/wt roost start --foreground<br>
Restart=always<br>
<br>
[Install]<br>
WantedBy=multi-user.target
</div>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">docker</h3>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">docker build -t wingthing .</span><br>
<span class="prompt">$ </span><span class="cmd">docker run -p 8080:8080 -v wt-data:/data wingthing</span>
</div>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">fly.io</h3>
<div class="docs-code">
<span class="prompt">$ </span><span class="cmd">fly launch --name my-wingthing</span><br>
<span class="prompt">$ </span><span class="cmd">fly deploy</span>
</div>
</div>

<div class="docs-section" id="roost-configuration">
<h2>roost configuration</h2>
<table class="docs-table">
<tr><th>var</th><th>purpose</th></tr>
<tr><td>WT_BASE_URL</td><td>public URL for OAuth callbacks</td></tr>
<tr><td>GITHUB_CLIENT_ID</td><td>GitHub OAuth app ID</td></tr>
<tr><td>GITHUB_CLIENT_SECRET</td><td>GitHub OAuth app secret</td></tr>
<tr><td>GOOGLE_CLIENT_ID</td><td>Google OAuth client ID</td></tr>
<tr><td>GOOGLE_CLIENT_SECRET</td><td>Google OAuth client secret</td></tr>
<tr><td>OPENAI_API_KEY</td><td>embeddings (optional)</td></tr>
<tr><td>WT_JWT_KEY</td><td>EC P-256 private key (PEM or base64-DER) for JWT signing (<strong>required</strong> in server mode, auto-generated in local/roost mode)</td></tr>
<tr><td>WT_APP_HOST</td><td>hostname for app subdomain (e.g. app.example.com)</td></tr>
<tr><td>WT_WS_HOST</td><td>hostname for WebSocket subdomain (e.g. ws.example.com)</td></tr>
</table>
<p>Without OAuth env vars, the server auto-enables local mode (single-user, no login page). Pass <code>--local</code> explicitly to force it.</p>
</div>

<div class="docs-section" id="architecture">
<h2>architecture</h2>
<p>The roost is a dumb pipe. It forwards encrypted blobs between browsers and wings without reading them. All session data, terminal output, file listings, and audit recordings are end-to-end encrypted. The roost knows wing IDs and connection state - nothing else.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">how the pieces connect</h3>
<p>Your wing opens an outbound WebSocket to the roost and holds it open. When you open a terminal in the browser, the browser connects to the roost over a second WebSocket. The roost matches them by wing ID and forwards messages both ways. All traffic is encrypted end-to-end.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">encryption</h3>
<p>Every connection between your browser and your wing gets a fresh X25519 key pair on both sides. The two do a Diffie-Hellman exchange, derive an AES-GCM key via HKDF, and encrypt everything from that point. Terminal I/O, file listings, session history, audit data - all ciphertext as far as the roost is concerned. Keys live in sessionStorage and vanish when you close the tab. Previous sessions can't be decrypted, even by the wing.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">passkey auth</h3>
<p>Encryption keeps the roost from reading your data. Passkeys control who can start sessions in the first place. When your wing is locked, the browser sends a WebAuthn assertion directly to the wing inside the encrypted channel. The roost forwards the blob but can't read or forge it. The wing verifies the signature against its local allowlist and issues a boot-scoped nonce for subsequent requests.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">what the roost stores</h3>
<p>User accounts, OAuth tokens, org membership, device auth tokens, bandwidth counters. That's it. No terminal data, no file contents, no session recordings. If you self-host, the SQLite database contains only auth state.</p>
</div>

<div class="docs-section" id="security">
<h2>security</h2>
<p>Three security domains, each solving a different problem.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">the egg: protecting you from the agent</h3>
<p>Agents run inside a platform-native sandbox - Seatbelt on macOS, user namespaces + seccomp on Linux. The sandbox controls filesystem access, network reach, and system calls. Configure it with <code>egg.yaml</code>; see <a href="#egg-configuration">egg configuration</a>.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">the wing: protecting you from the roost</h3>
<p>All traffic between your browser and your wing is E2E encrypted (X25519 + AES-GCM). The roost forwards ciphertext and can't read it. Wings connect outbound only - no inbound ports, no static IP, works behind any NAT or firewall. Lock your wing and sessions require a <a href="#access-control">passkey</a> on top of encryption - the roost can't start sessions on your behalf even if it wanted to.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">the roost: controlling access</h3>
<p>The roost handles login (OAuth, device auth) and routes connections to the right wing. When a wing is locked, the roost stores passkey credential IDs so it can hand them to the wing during <code>wt wing allow</code> - but the WebAuthn verification happens on the wing, not the roost. See <a href="#access-control">access control</a>.</p>

<h3 style="font-size:14px;margin:16px 0 8px;color:var(--text)">what the sandbox enforces</h3>
<table class="docs-table">
<tr><th>feature</th><th>macOS</th><th>Linux</th></tr>
<tr><td>deny paths (.ssh, .aws, etc.)</td><td>SBPL rules</td><td>tmpfs overlays</td></tr>
<tr><td>write isolation (HOME read-only)</td><td>SBPL rules</td><td>bind-mount read-only + writable holes</td></tr>
<tr><td>network deny</td><td>full block via SBPL</td><td>network namespace (CLONE_NEWNET)</td></tr>
<tr><td>domain filtering</td><td>SBPL forces traffic through local CONNECT proxy; only whitelisted domains pass</td><td>CONNECT proxy via HTTPS_PROXY (cooperative)</td></tr>
<tr><td>seccomp syscall filter</td><td>n/a</td><td>blocks mount, ptrace, kexec, setns, unshare, bpf, open_by_handle_at, and 20+ more</td></tr>
<tr><td>resource limits (CPU, mem, FDs)</td><td>not available</td><td>cgroups v2 (memory, PIDs) + rlimit(2) (CPU, virtual address space, FDs)</td></tr>
<tr><td>PID isolation</td><td>n/a</td><td>CLONE_NEWPID</td></tr>
</table>
<p style="font-size:12px;color:var(--text-dim)">* See sandbox limits below.</p>
</div>

<div class="docs-section" id="sandbox-limits">
<h2>sandbox limits</h2>
<p>The sandbox is not a container runtime. Known gaps:</p>
<ul>
<li><strong>Linux domain filtering is cooperative.</strong> The CONNECT proxy is set via <code>HTTPS_PROXY</code>. Agent harnesses that respect proxy env vars (Claude Code, Codex, most Node.js and Go tooling) route through it automatically. An agent that spawns raw sockets can skip it. On macOS, Seatbelt forces all traffic through the proxy at the OS level. If your agent's harness doesn't respect <code>HTTPS_PROXY</code>, <a href="https://github.com/ehrlich-b/wingthing/issues">file an issue</a>.</li>
<li><strong>Agent credentials are readable.</strong> API keys and config files are mounted into the sandbox. The agent can read them, but domain filtering means the only place it can send them is the agent's own API.</li>
<li><strong>HOME is readable.</strong> The agent reads your codebase. Add <code>"deny:~/.secrets"</code> to the <code>fs</code> list to hide sensitive directories.</li>
<li><strong>Agent config is writable.</strong> <code>~/.claude/</code> and similar directories must be writable for the agent to function.</li>
<li><strong>Resource limits are Linux-only.</strong> macOS agents can consume unbounded CPU and memory. On Linux, cgroups v2 limits real memory (RSS) and process count; rlimit covers CPU time, virtual address space, and file descriptors. Cgroups require v2 with delegation. Falls back to rlimit-only when unavailable.</li>
</ul>
<p>These are on the roadmap. If any of these are blocking you, <a href="https://github.com/ehrlich-b/wingthing/issues">file an issue</a> - it helps us prioritize. If you need hard isolation today, run wingthing inside a VM or container.</p>
</div>


</div>
</div>
{{end}}
